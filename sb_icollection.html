<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Overview of the bsui+xpdAcq environment &mdash; xpdAcq 1.1.2 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Setting up your Beamtime" href="usb_Beamtime.html" />
    <link rel="prev" title="Overview of xpd acquisition environment" href="sb_overview.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> xpdAcq
          </a>
              <div class="version">
                1.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="xpdusers.html">For XPD Users</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="sb_overview.html">Overview of xpd acquisition environment</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Overview of the bsui+xpdAcq environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nsls-ii-data-philosophy">NSLS-II data philosophy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#xpdacq-philosophy">xpdAcq philosophy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usb_Beamtime.html">Setting up your Beamtime</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb_Experiment.html">Setting up your XPD acquisition objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb_Scan.html">ScanPlan objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb_Where.html">Where did all my Sample and Scan objects go?????</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb_Where.html#bt-list-is-your-friends">bt.list() is your friends</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb_Where.html#bt-list-gotchas">bt.list() Gotchas</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb_Running.html">Running scans</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb_QuickAssess.html">Initial assessment of your data</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb_GlobalOptions.html">xpdAcq Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="db_export.html">Databroker Export</a></li>
<li class="toctree-l2"><a class="reference internal" href="robot.html">Using the Robot</a></li>
<li class="toctree-l2"><a class="reference internal" href="tomo.html">Running Tomography</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb_design.html">An overhaul at v1.1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb_calibration.html">Automated Calibration Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb_darkframe.html">Automatic Dark Frame</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb_mask.html">Mask Data Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb_shutter.html">Automatic Shutter Control</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api_doc.html">API Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="beamlinestaff.html">For Beamline Staff</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">xpdAcq Change Log</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">xpdAcq</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="xpdusers.html">For XPD Users</a></li>
      <li class="breadcrumb-item active">Overview of the bsui+xpdAcq environment</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/sb_icollection.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="overview-of-the-bsui-xpdacq-environment">
<span id="sb-icollection"></span><h1>Overview of the bsui+xpdAcq environment<a class="headerlink" href="#overview-of-the-bsui-xpdacq-environment" title="Permalink to this heading"></a></h1>
<p>All data collection at NSLS-II is carried out through a powerful
Python-software-language based interface which runs in an ipython interactive
session. By typing <code class="docutils literal notranslate"><span class="pre">xpdui</span></code> at the unix prompt (command line) in a terminal
window at the XPD computer you begin an ipython session and preload an ipython
profile (called <code class="docutils literal notranslate"><span class="pre">collection</span></code>) that contains all the software to run the NSLS-II
data collection software.</p>
<p>You can tell when you are in the <code class="docutils literal notranslate"><span class="pre">collection</span></code> environment
because you will see <code class="docutils literal notranslate"><span class="pre">(collection-yyQn.x)</span></code> at the beginning of the command-line.
<code class="docutils literal notranslate"><span class="pre">yy</span></code> stands for year and <code class="docutils literal notranslate"><span class="pre">Qn.x</span></code> tells detailed information about the
version. For example, <code class="docutils literal notranslate"><span class="pre">collection-17Q1.0</span></code> would mean the fist version of
quarter 1, in 2017.When you are not in the environment you won’t see that. There is also an analysis environment, which is currently called <code class="docutils literal notranslate"><span class="pre">analysis</span></code>,
that is very similar to the <code class="docutils literal notranslate"><span class="pre">collection</span></code> environment but it is for data
analysis functions and you cannot control any XPD hardware from it.  This may
be run on a different computer than the control software, as long as it can see
the NSLS-II data database.   This environment is activated by typing <code class="docutils literal notranslate"><span class="pre">ianalysis</span></code>
in a fresh terminal on one of the XPD linux computers.</p>
<p>Inside the <code class="docutils literal notranslate"><span class="pre">collection-yyQn.x</span></code> environment you can type commands that will control the
diffractometer, collect data, and also extract data from the NSLS-II database.
The NSLS-II data acquisition environment is powerful and flexible, but there is a
stiff learning curve to using it.  We have therefore added a layer on top that
is a package of programs called <code class="docutils literal notranslate"><span class="pre">xpdAcq</span></code> that are designed to make the data
acquisition at XPD easier and more robust for most people.  We strongly suggest
that you use the xpdacq functions as much as possible.</p>
<section id="nsls-ii-data-philosophy">
<h2>NSLS-II data philosophy<a class="headerlink" href="#nsls-ii-data-philosophy" title="Permalink to this heading"></a></h2>
<p>NSLS-II is committed to archiving all raw data, and making it available to
authorized users.  For this to succeed it is important to be able to find the
data when it is desired.  The basic philosophy at NSLS-II is therefore to
tag every dataset with unique-ID tags, and to save rich metadata with each saved
frame that can be searched on to find the data.  The <code class="docutils literal notranslate"><span class="pre">xpdAcq</span></code> package is designed
to make the user inputs easier when collecting data, and to facilitate the saving
of rich and correct metadata with the saved data for easier retrieval later.  It is
hoped that this will greatly speed up and facilitate users’ later data analysis
and modeling workflows.
You are reading the xpdAcq documentation.  Documentation for the NSLS-II data acquisition
package, ‘Bluesky’ can be found <a class="reference external" href="http://nsls-ii.github.io/bluesky/">here</a>.</p>
</section>
<section id="xpdacq-philosophy">
<h2>xpdAcq philosophy<a class="headerlink" href="#xpdacq-philosophy" title="Permalink to this heading"></a></h2>
<p>When we are running the experiment we pretty much just want to be worrying about
setting up and running the scans, but to find the data later, and to help with
processing it (in the future the metadata will be passed directly to the data
reduction software) it is important that a complete stack of metadata is saved
with each scan.  The philosophy of the xpdAcq software is to accomplish this.</p>
<p>Metadata comes from a number of sources: beamtime information, sample information, scan information, and
information coming from hardware during the experiment (such as sample temperature, for example).
With this in mind, <code class="docutils literal notranslate"><span class="pre">xpdAcq</span></code> assumes that you may be doing multiple scans on the same sample,
and so we define a scan as the union of a scan-plan (which contains all the parameters of the
scan you want to run) and a sample.  Beamtime metadata consists of the SAF number, PI name,
list of experimenters and so on and is set up by the beamline scientist at the beginning of your
beamtime.  There can be a wealth of information about your sample that you want to save.  To make
this easier, we provide an excel spreadsheet that you can fill in before (or during) your experiment
that contains information about each separate sample that you will run.
When you run a scan using <code class="docutils literal notranslate"><span class="pre">xrun</span></code> and specifying a scan-plan and a sample,
<code class="docutils literal notranslate"><span class="pre">xpdAcq</span></code> will take all the beamtime metadata, the sample metadata, and all the parameters of the scan,
and save it in the scan header in the metadata store, linked to the actual dataset itself. You may also
specify more metadata to save when the scan is run by specifying it in <code class="docutils literal notranslate"><span class="pre">xrun</span></code>.   Additional metadata
are also saved, such as a link to the <code class="docutils literal notranslate"><span class="pre">xpdAcq</span></code>’s best guess at the right dark-collection to use for correcting
your scan data, calibration parameters for the experimental setup, and so on.  These can be overridden during analysis
so don’t worry if they are incorrectly saved, but following the preferred <code class="docutils literal notranslate"><span class="pre">xpdAcq</span></code> workflow during data collection
can save you a lot of  time later by making these guesses correct.   Hardware generated metadata, such as sample temperature,
are also saved and can be retrieved later.</p>
<p>Later you will be able to use the scan metadata to search for your scans from the XPD database.  For example, a search
on the PI-last name and a date-range will return all the datasets you collected in that date-range.  If you add sample name
it will return all the scans done on that sample in that date-range and so on.</p>
<p>With this information in mind, please go ahead and start the step-by-step process
of setting up your beamtime in <a class="reference internal" href="usb_Beamtime.html#usb-beamtime"><span class="std std-ref">Setting up your Beamtime</span></a></p>
<p>return to <a class="reference internal" href="xpdusers.html#xpdu"><span class="std std-ref">For XPD Users</span></a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="sb_overview.html" class="btn btn-neutral float-left" title="Overview of xpd acquisition environment" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="usb_Beamtime.html" class="btn btn-neutral float-right" title="Setting up your Beamtime" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright (c) 2016 trustees of Columbia University in the City of New York.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>